mod rule;

use anyhow::Result;

use crate::sysmon_event::SysmonEvent;
use rule::{FileCreate, Rules};

pub fn detect(events: &Vec<SysmonEvent>) -> Result<Vec<SysmonEvent>> {
    let mut rules = Rules::new();

    rules.add(FileCreate {
        file_name: "hello.txt",
    });

    Ok(rules.match_all(events))
}
