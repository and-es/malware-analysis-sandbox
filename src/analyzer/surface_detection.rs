use anyhow::Result;
use yara::Compiler;

fn main() -> Result<()> {
    let compiler = Compiler::new()?.add_rules_file("rule.yar")?;
    let rules = compiler.compile_rules()?;
    let results = rules.scan_file("test.sh", 5)?;
    println!("{:?}", results);

    Ok(())
}
