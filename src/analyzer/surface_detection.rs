use std::path::Path;

use anyhow::Result;
use yara::Compiler;

pub fn detect<T: AsRef<Path>, U: AsRef<Path>>(
    sample_path: T,
    yara_path: U,
    timeout: i32,
) -> Result<bool> {
    let compiler = Compiler::new()?.add_rules_file(yara_path)?;
    let rules = compiler.compile_rules()?;
    let results = rules.scan_file(sample_path, timeout)?;
    if results.len() > 0 {
        Ok(true)
    } else {
        Ok(false)
    }
}
